<!DOCTYPE html>
<html lang="en" class="overflow-x-hidden">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Car Owner Partnership Agreement - Carry Rental Services</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Join Carry Rental Services as a car owner partner. 70-30 revenue sharing model for self-drive car rental partnership in Rajasthan.">
  <meta name="keywords" content="car owner partnership, CRS agreement, car rental partnership, 70-30 model">
  <meta name="author" content="Carry Rental Services">

  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { primary: "#034bc0", secondary: "#4B4B4B" },
          borderRadius: {
            none: "0px",
            sm: "4px",
            DEFAULT: "8px",
            md: "12px",
            lg: "16px",
            xl: "20px",
            "2xl": "24px",
            "3xl": "32px",
            full: "9999px",
            button: "8px",
          },
        },
      },
    };
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com/" />
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" type="image/png" href="assets/favicon-rc-new.png" sizes="192x192">
  <link rel="apple-touch-icon" href="assets/favicon-rc-new.png">
  <link rel="shortcut icon" href="assets/favicon-rc-new.png">

  <!-- EmailJS (optional, enable by adding your keys below) -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    // 👉 Replace with your EmailJS public key to enable direct email sending.
    const EMAILJS_PUBLIC_KEY = ""; // e.g., "mYpUbLiCkEy123"
    const EMAILJS_SERVICE_ID = ""; // e.g., "service_xxxxxx"
    const EMAILJS_TEMPLATE_ID = ""; // e.g., "template_xxxxxx"
    if (EMAILJS_PUBLIC_KEY) {
      emailjs.init(EMAILJS_PUBLIC_KEY);
    }
  </script>

  <style>
    :root{
      --crs-red-1:#8B0000; --crs-red-2:#DC143C; --crs-gold:#fbc02d;
    }
    body {font-family: 'Montserrat', sans-serif; scroll-behavior: smooth; background: linear-gradient(135deg, var(--crs-red-1) 0%, var(--crs-red-2) 100%); min-height: 100vh; position: relative; overflow-x: hidden;}
    .bg-pattern {position: fixed; inset:0; opacity: .03; background-image: radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 1px, transparent 1px), radial-gradient(circle at 80% 70%, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 50px 50px; pointer-events: none; z-index: 0;}
    .agreement-wrapper {padding-top: 140px; padding-bottom: 80px; position: relative; z-index: 10;}
    .agreement-container {max-width: 1100px; margin: 0 auto; background: rgba(255, 255, 255, 0.98); border-radius: 20px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); backdrop-filter: blur(10px); position: relative;}
    .page-heading h1 {font-size: 38px; color: var(--crs-red-1); margin-bottom: 10px; font-weight: 700; text-shadow: 2px 2px 4px rgba(0,0,0,0.08); line-height: 1.3;}
    .divider {width: 80px; height: 4px; background: linear-gradient(90deg, var(--crs-red-1), var(--crs-red-2)); margin: 16px auto 0; border-radius: 2px;}
    .fill-input {border-bottom: 2px solid var(--crs-red-2); padding: 6px 4px; min-width: 220px; outline: none; background: transparent; font-weight:600; color:#222;}
    .fill-input::placeholder{color:#b9b9b9; font-weight:500;}
    .soft-card {background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%); border-left:5px solid var(--crs-red-2); border-radius: 12px; padding: 18px;}
    .term-item {margin-bottom: 22px;}
    .term-item:hover {box-shadow: 0 8px 30px rgba(220, 20, 60, 0.16); transform: translateX(2px);}
    .vehicle-table {width:100%; border-collapse: collapse; margin: 10px 0 8px; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.08);}
    .vehicle-table th {background: linear-gradient(135deg, var(--crs-red-2), var(--crs-red-1)); color: white; padding: 12px; text-align: left; font-weight: 600; font-size: 14px;}
    .vehicle-table td {padding: 8px; border-bottom: 1px solid #eee;}
    .vehicle-input {width: 100%; border: 1px solid #e5e7eb; border-radius: 8px; padding: 8px 10px; font-size: 14px;}
    .btn {display:inline-flex; align-items:center; gap:.55rem; border-radius: 999px; padding: 10px 18px; font-weight:700; cursor: pointer;}
    .btn-primary{ background: linear-gradient(135deg, var(--crs-red-2), var(--crs-red-1)); color:#fff; box-shadow:0 8px 25px rgba(220,20,60,.35)}
    .btn-ghost{ background:#fff; border:2px solid var(--crs-red-2); color: var(--crs-red-1)}
    .footer-note {background: linear-gradient(135deg, var(--crs-red-1), var(--crs-red-2)); color: #fff; padding: 18px; border-radius: 12px; text-align: center; margin-top: 24px;}
    .scroll-progress {position: fixed; top: 0; left: 0; width: 0%; height: 4px; background: linear-gradient(90deg, var(--crs-red-2), #FF1744); z-index: 10000; transition: width 0.1s ease; box-shadow: 0 2px 10px rgba(220, 20, 60, 0.5);}
    
    /* Signature Canvas Styles */
    .signature-pad {border: 2px dashed #ccc; border-radius: 8px; background: #f9f9f9; cursor: crosshair; margin-top: 10px;}
    .signature-actions {display: flex; gap: 10px; margin-top: 10px;}
    .signature-clear {background: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;}
    .signature-save {background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;}
    
    /* Company Details Section */
    .company-details {display: flex; align-items: center; gap: 20px; margin-top: 15px;}
    .company-logo {width: 80px; height: 80px; border-radius: 10px; object-fit: contain; border: 2px solid var(--crs-red-1);}
    .company-info {flex: 1;}
    .company-qr {width: 100px; height: 100px; border-radius: 8px; object-fit: cover;}
    
    /* Payment Options */
    .payment-options {display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px;}
    .payment-option {flex: 1; min-width: 200px; background: #f5f5f5; padding: 15px; border-radius: 8px; text-align: center;}
    .payment-icon {font-size: 24px; margin-bottom: 10px;}
    
    /* Bottom Actions */
    .bottom-actions {margin-top: 40px; padding-top: 30px; border-top: 2px dashed #DC143C;}
    
    @media (max-width:768px){ 
      .agreement-wrapper{padding-top:100px;} 
      .page-heading h1{font-size:30px;} 
      .company-details {flex-direction: column; text-align: center;}
      .payment-option {min-width: 100%;}
    }
    
    /* Print styles for Save as PDF */
    @media print {
      body{background:white}
      header, .download-section, .actions-bar, .scroll-progress, .mobile-menu, .nav-hamburger {display:none !important}
      .agreement-container{box-shadow:none; padding:0}
      .btn, .btn-primary, .btn-ghost{display:none !important}
      input, select, textarea { border: none; outline: none; }
      .signature-pad {border: 1px solid #000;}
    }
  </style>
</head>
<body class="overflow-x-hidden">
  <!-- Scroll Progress Bar -->
  <div class="scroll-progress" id="scrollProgress"></div>
  <!-- Background Pattern -->
  <div class="bg-pattern"></div>

  <!-- HEADER START -->
  <header class="header-bar">
    <nav class="nav-container">
      <a href="index.html" class="nav-logo">
        <img src="images/carryrentalservices-logo.png" alt="Carry Rental Services" class="logo-img" style="max-height:44px;min-width:44px"/>
        <span class="logo-text"></span>
      </a>
      <ul class="nav-menu">
        <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
        <li class="nav-item"><a href="#agreement-top" class="nav-link">Agreement</a></li>
        <li class="nav-item"><a href="services.html" class="nav-link">Service</a></li>
        <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
      </ul>
      <a href="https://wa.me/918003990475?text=I'm%20interested%20in%20Car%20Rental%20Services" class="nav-cta bg-[#e31919] text-white font-semibold px-5 py-2 rounded-full">Book Your Ride <span class="cta-icon">→</span></a>
      <div class="nav-hamburger" id="hamburger-btn"><span></span><span></span><span></span></div>
    </nav>
    <div class="mobile-menu" id="mobile-menu">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="#agreement-top">Agreement</a></li>
        <li><a href="services.html">Service</a></li>
        <li><a href="contact.html">Contact <span class="cta-icon">→</span></a></li>
      </ul>
    </div>
  </header>

  <style>
    .header-bar{position:fixed; top:24px; left:0; right:0; z-index:9999; width:100%; display:flex; justify-content:center; pointer-events:none}
    .nav-container{width:90vw; max-width:1300px; background:#fff; border-radius:48px; box-shadow:0 6px 32px rgba(32,50,90,.10); display:flex; align-items:center; padding:0 18px; min-height:74px; pointer-events:auto; gap:20px}
    .nav-logo{display:flex; align-items:center; gap:.6em; margin-right:22px}
    .logo-text{font-size:2rem; font-weight:700; letter-spacing:-2px; margin-top:1px}
    .nav-menu{display:flex; align-items:center; gap:8px; list-style:none; margin:0 0 0 16px; padding:0; flex:1 1 auto}
    .nav-link{display:flex; align-items:center; font-size:17px; font-weight:500; color:#202834; padding:16px 18px 16px 12px; border-radius:32px; text-decoration:none; transition:background .18s}
    .nav-link:hover{background:#ecf0fa; color:#e31919}
    .nav-cta{font-size:16px; box-shadow:0 2px 20px rgba(32,58,255,.11)}
    .nav-hamburger{display:none; flex-direction:column; justify-content:center; align-items:center; cursor:pointer; height:46px; width:46px; border-radius:100%; margin-left:18px; transition:background .2s}
    .nav-hamburger:hover{background:#f4f7fb}
    .nav-hamburger span{display:block; background:#222; height:4px; width:28px; border-radius:2px; margin:3px 0; transition:all .23s}
    .mobile-menu{display:none; flex-direction:column; align-items:center; position:fixed; top:100px; left:0; right:0; background:#fff; box-shadow:0 8px 32px rgba(31,38,135,.09); z-index:9999; border-radius:0 0 32px 32px; padding:22px 0 26px; pointer-events:auto}
    .mobile-menu ul{width:95vw; max-width:360px; margin:0 auto; padding:0; list-style:none; display:flex; flex-direction:column; gap:6px}
    .mobile-menu li a, .mobile-menu li{display:block; padding:14px 10px; color:#2d3652; font-size:18px; text-align:left; border-radius:22px; text-decoration:none; font-weight:500; margin:0; transition:background .16s, color .12s}
    .mobile-menu li a:hover{background:#ecf0fa; color:#e31919}
    @media (max-width:650px){ .nav-menu, .nav-cta{display:none} .nav-hamburger{display:flex} .mobile-menu{border-radius:0 0 16px 16px} .header-bar{top:10px} }
  </style>

  <!-- MAIN -->
  <main id="agreement-top" class="agreement-wrapper">
    <form id="agreementForm" class="agreement-container">
      <div class="page-heading text-center">
        <h1>Car Owner Partnership Agreement</h1>
        <div class="text-secondary/80 font-medium">(70-30 Partnership Model)</div>
        <div class="divider"></div>
        <p class="text-gray-600 mt-2">For Self-Drive Car Rental Partnership</p>
      </div>

      <!-- Date line -->
      <div class="text-center mb-6 text-gray-600">
        This Car Owner Agreement ("Agreement") is made on this
        <input class="fill-input" name="agreement_day" placeholder="DD" required pattern="^([0-2]?\d|3[01])$"/>
        day of
        <input class="fill-input" name="agreement_month" placeholder="Month" required/>
        <input class="fill-input" name="agreement_year" value="2025" placeholder="YYYY" required pattern="^20\d{2}$"/>, between:
      </div>

      <!-- Party 1: CRS -->
      <section class="soft-card mb-5">
        <h3 class="text-[20px] font-bold text-[var(--crs-red-1)]">1. Carry Rental Services (CRS)</h3>
        
        <div class="company-details">
          <div class="company-info">
            <div class="grid md:grid-cols-3 gap-4 mt-2">
              <label class="block">
                <span class="text-sm text-gray-500 font-semibold">Represented by</span>
                <input class="vehicle-input" name="crs_rep" value="Mr. Abhishek Meena, Founder & CEO" required/>
              </label>
              <label class="block md:col-span-2">
                <span class="text-sm text-gray-500 font-semibold">Address</span>
                <input class="vehicle-input" name="crs_address" value="Gangapur City, District Sawai Madhopur, Rajasthan" required/>
              </label>
              <label class="block">
                <span class="text-sm text-gray-500 font-semibold">Email</span>
                <input class="vehicle-input" name="crs_email" value="carryrentalservices@gmail.com" required/>
              </label>
              <label class="block">
                <span class="text-sm text-gray-500 font-semibold">Phone</span>
                <input class="vehicle-input" name="crs_phone" value="+91 80039 90475" required/>
              </label>
            </div>
          </div>
          <div class="text-center">
            <div class="text-sm text-gray-500 font-semibold mb-2">Company Logo</div>
            <img src="images/carryrentalservices-logo.png" alt="Carry Rental Services" class="company-logo">
          </div>
        </div>
        
        <p class="italic text-gray-500 mt-2">(Hereinafter referred to as "Company")</p>
      </section>

      <!-- Party 2: Owner -->
      <section class="soft-card mb-5">
        <h3 class="text-[20px] font-bold text-[var(--crs-red-1)]">2. Car Owner Details</h3>
        <div class="grid md:grid-cols-2 gap-4 mt-2">
          <label class="block">
            <span class="text-sm text-gray-500 font-semibold">Owner Name</span>
            <input class="vehicle-input" name="owner_name" placeholder="Full Name" required/>
          </label>
          <label class="block">
            <span class="text-sm text-gray-500 font-semibold">Mobile No.</span>
            <input class="vehicle-input" name="owner_mobile" placeholder="10-digit mobile" required pattern="^[6-9]\d{9}$"/>
          </label>
          <label class="block md:col-span-2">
            <span class="text-sm text-gray-500 font-semibold">Address</span>
            <input class="vehicle-input" name="owner_address" placeholder="Complete postal address" required/>
          </label>
          <label class="block">
            <span class="text-sm text-gray-500 font-semibold">Aadhar No.</span>
            <input class="vehicle-input" name="owner_aadhar" placeholder="XXXX-XXXX-XXXX" required pattern="^\d{4}-?\d{4}-?\d{4}$"/>
          </label>
          <label class="block">
            <span class="text-sm text-gray-500 font-semibold">Email (for copy)</span>
            <input class="vehicle-input" name="owner_email" placeholder="owner@example.com" type="email"/>
          </label>
        </div>
        <p class="italic text-gray-500 mt-2">(Hereinafter referred to as "Owner")</p>
      </section>

      <!-- Vehicle Details -->
      <section class="term-item soft-card">
        <div class="flex items-center gap-2 text-[var(--crs-red-1)] font-semibold text-lg"><span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-white" style="background:linear-gradient(135deg, var(--crs-red-2), #FF1744)">1</span> Vehicle Details</div>
        <table class="vehicle-table mt-3" id="vehicleTable">
          <thead>
            <tr>
              <th>Make/Model</th>
              <th>Registration No.</th>
              <th>Year</th>
              <th>Color</th>
              <th>Fuel</th>
              <th>Insurance Exp.</th>
              <th>Fitness Exp.</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><input class="vehicle-input" name="veh[0][model]" placeholder="e.g., Swift VXI" required></td>
              <td><input class="vehicle-input" name="veh[0][reg]" placeholder="RJxx XX xxxx" required></td>
              <td><input class="vehicle-input" name="veh[0][year]" placeholder="YYYY" pattern="^20\d{2}|19\d{2}$" required></td>
              <td><input class="vehicle-input" name="veh[0][color]" placeholder="Color"></td>
              <td>
                <select class="vehicle-input" name="veh[0][fuel]">
                  <option>Petrol</option><option>Diesel</option><option>CNG</option><option>EV</option>
                </select>
              </td>
              <td><input type="date" class="vehicle-input" name="veh[0][ins]" required></td>
              <td><input type="date" class="vehicle-input" name="veh[0][fit]" required></td>
            </tr>
          </tbody>
        </table>
        <div class="flex gap-3">
          <button class="btn btn-ghost" type="button" onclick="addVehicleRow()">＋ Add Vehicle</button>
          <button class="btn btn-ghost" type="button" onclick="removeVehicleRow()">— Remove Last</button>
        </div>
      </section>

      <!-- Revenue split visual -->
      <section class="soft-card">
        <div class="grid sm:grid-cols-3 gap-4 items-center">
          <div class="text-center">
            <div class="text-5xl font-extrabold text-green-700">70%</div>
            <div class="font-semibold text-gray-600">To Car Owner</div>
          </div>
          <div class="text-center text-3xl font-black">⟷</div>
          <div class="text-center">
            <div class="text-5xl font-extrabold text-green-700">30%</div>
            <div class="font-semibold text-gray-600">To Company</div>
          </div>
        </div>
      </section>

      <!-- Key Terms (editable acknowledgements) -->
      <section class="terms-section">
        <div class="term-item soft-card">
          <div class="flex items-center gap-2 text-[var(--crs-red-1)] font-semibold text-lg"><span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-white" style="background:linear-gradient(135deg, var(--crs-red-2), #FF1744)">2</span> Revenue & Payout</div>
          <div class="text-gray-700 mt-2 space-y-2">
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_revenue"> <span>Rental revenue from bookings will be shared as <b>70% Owner / 30% Company</b> after applicable taxes & standard deductions (tolls, fines, damage recoveries from customer, etc.).</span></label>
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_payout"> <span>Payouts are processed <b>within 3–5 working days</b> after trip completion, to the bank account provided by the Owner.</span></label>
          </div>
        </div>
        <div class="term-item soft-card">
          <div class="flex items-center gap-2 text-[var(--crs-red-1)] font-semibold text-lg"><span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-white" style="background:linear-gradient(135deg, var(--crs-red-2), #FF1744)">3</span> Vehicle Condition & Documents</div>
          <div class="text-gray-700 mt-2 space-y-2">
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_docs"> <span>Owner confirms vehicle has valid <b>RC, Insurance, PUC, Fitness</b> and all permits as required.</span></label>
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_service"> <span>Owner will keep the vehicle serviced and roadworthy. Consumables and routine maintenance are borne by Owner.</span></label>
          </div>
        </div>
        <div class="term-item soft-card">
          <div class="flex items-center gap-2 text-[var(--crs-red-1)] font-semibold text-lg"><span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-white" style="background:linear-gradient(135deg, var(--crs-red-2), #FF1744)">4</span> Damage, Accidents & Fines</div>
          <div class="text-gray-700 mt-2 space-y-2">
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_damage"> <span>Any customer-caused damages are claimed from security deposit/insurance as per policy. Company assists in claim coordination.</span></label>
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_fines"> <span>Traffic challans/fines during customer use are recovered from the customer.</span></label>
          </div>
        </div>
        <div class="term-item soft-card">
          <div class="flex items-center gap-2 text-[var(--crs-red-1)] font-semibold text-lg"><span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-white" style="background:linear-gradient(135deg, var(--crs-red-2), #FF1744)">5</span> Duration & Termination</div>
          <div class="text-gray-700 mt-2 space-y-2">
            <label class="flex items-start gap-2"><input type="checkbox" class="mt-1" required name="ack_term"> <span>This agreement is valid until either party provides <b>7 days written notice</b> for termination.</span></label>
          </div>
        </div>
      </section>

      <!-- Bank Details -->
      <section class="soft-card">
        <h3 class="text-[20px] font-bold text-[var(--crs-red-1)]">Owner Bank Details (for payouts)</h3>
        <div class="grid md:grid-cols-3 gap-4 mt-2">
          <label class="block"><span class="text-sm text-gray-500 font-semibold">Account Holder</span><input class="vehicle-input" name="bank_name" placeholder="As per bank" required></label>
          <label class="block"><span class="text-sm text-gray-500 font-semibold">Account No.</span><input class="vehicle-input" name="bank_ac" placeholder="XXXXXXXXXXXX" required></label>
          <label class="block"><span class="text-sm text-gray-500 font-semibold">IFSC</span><input class="vehicle-input" name="bank_ifsc" placeholder="XXXX0XXXXX" required></label>
        </div>
        
        <div class="mt-4">
          <h4 class="text-lg font-semibold text-[var(--crs-red-1)] mb-2">Payment Options</h4>
          <div class="payment-options">
            <div class="payment-option">
              <div class="payment-icon">🏦</div>
              <div class="font-semibold">Bank Transfer</div>
              <div class="text-sm text-gray-600">NEFT/IMPS/RTGS</div>
            </div>
            <div class="payment-option">
              <div class="payment-icon">📱</div>
              <div class="font-semibold">UPI Payment</div>
              <div class="text-sm text-gray-600">8003990475@ybl</div>
            </div>
            <div class="payment-option">
              <div class="payment-icon">💳</div>
              <div class="font-semibold">QR Code</div>
              <div class="text-sm text-gray-600">Scan & Pay</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Company Bank Details -->
      <section class="soft-card">
        <h3 class="text-[20px] font-bold text-[var(--crs-red-1)]">Company Bank Details (for payments)</h3>
        <div class="grid md:grid-cols-2 gap-4 mt-2">
          <div>
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Bank Name</span>
            <input class="vehicle-input" value="Bank of Baroda" readonly></label>
          </div>
          <div>
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Account Holder</span>
            <input class="vehicle-input" value="Abhishek Meena" readonly></label>
          </div>
          <div>
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Account Number</span>
            <input class="vehicle-input" value="20720100007761" readonly></label>
          </div>
          <div>
            <label class="block"><span class="text-sm text-gray-500 font-semibold">IFSC Code</span>
            <input class="vehicle-input" value="BARB0MORDAX" readonly></label>
          </div>
        </div>
      </section>

      <!-- Signature Section -->
      <section class="grid md:grid-cols-2 gap-4 mt-6">
        <div class="soft-card">
          <h4 class="text-[18px] font-semibold text-[var(--crs-red-1)]">For Company (CRS)</h4>
          <div class="grid gap-3 mt-2">
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Authorized Signatory</span><input class="vehicle-input" name="crs_sign_name" value="Abhishek Meena" required></label>
            
            <div>
              <span class="text-sm text-gray-500 font-semibold">Digital Signature</span>
              <div class="signature-pad-container">
                <canvas id="crsSignaturePad" class="signature-pad" width="300" height="150"></canvas>
                <div class="signature-actions">
                  <button type="button" class="signature-clear" onclick="clearSignature('crs')">Clear</button>
                  <button type="button" class="signature-save" onclick="saveSignature('crs')">Save</button>
                </div>
              </div>
            </div>
            
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Date</span><input type="date" class="vehicle-input" name="crs_sign_date" required></label>
          </div>
        </div>
        
        <div class="soft-card">
          <h4 class="text-[18px] font-semibold text-[var(--crs-red-1)]">Car Owner</h4>
          <div class="grid gap-3 mt-2">
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Owner Name</span><input class="vehicle-input" name="owner_sign_name" placeholder="Type full name" required></label>
            
            <div>
              <span class="text-sm text-gray-500 font-semibold">Digital Signature</span>
              <div class="signature-pad-container">
                <canvas id="ownerSignaturePad" class="signature-pad" width="300" height="150"></canvas>
                <div class="signature-actions">
                  <button type="button" class="signature-clear" onclick="clearSignature('owner')">Clear</button>
                  <button type="button" class="signature-save" onclick="saveSignature('owner')">Save</button>
                </div>
              </div>
            </div>
            
            <label class="block"><span class="text-sm text-gray-500 font-semibold">Date</span><input type="date" class="vehicle-input" name="owner_sign_date" required></label>
          </div>
        </div>
      </section>

      <!-- Help Section -->
      <section class="soft-card mt-6">
        <h3 class="text-[20px] font-bold text-[var(--crs-red-1)]">Need Help?</h3>
        <div class="grid md:grid-cols-2 gap-4 mt-2">
          <div>
            <h4 class="font-semibold text-gray-700 mb-2">📞 Contact Support</h4>
            <ul class="text-gray-600 space-y-1">
              <li>Phone: <strong>+91 80039 90475</strong></li>
              <li>Email: <strong>carryrentalservices@gmail.com</strong></li>
              <li>WhatsApp: <strong>+91 80039 90475</strong></li>
            </ul>
          </div>
          <div>
            <h4 class="font-semibold text-gray-700 mb-2">💡 Quick Tips</h4>
            <ul class="text-gray-600 space-y-1">
              <li>Fill all fields accurately</li>
              <li>Double-check vehicle details</li>
              <li>Save PDF for your records</li>
              <li>Contact us for any clarifications</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Bottom Actions -->
      <div class="bottom-actions">
        <div class="actions-bar flex flex-wrap gap-3 justify-center mb-6">
          <button type="button" class="btn btn-primary" onclick="saveAsPDF()">📄 Save/Print PDF</button>
          <button type="button" class="btn btn-ghost" onclick="previewEmail()">✉️ Preview Email</button>
          <button type="submit" class="btn btn-primary">📧 Submit to CRS</button>
        </div>
        
        <div class="footer-note rounded-xl">
          <strong class="block text-lg">Note</strong>
          <p>After filling, press <b>Submit to CRS</b> to email details to <b>carryrentalservices@gmail.com</b>. You can also <b>Save/Print PDF</b> for your records.</p>
        </div>
      </div>

      <!-- Hidden field: where to send -->
      <input type="hidden" name="send_to" value="carryrentalservices@gmail.com"/>
    </form>
  </main>

  <!-- JS: interactions -->
  <script>
    // Mobile menu
    const hamb = document.getElementById('hamburger-btn');
    const mob = document.getElementById('mobile-menu');
    hamb && hamb.addEventListener('click', ()=>{
      mob.style.display = mob.style.display === 'flex' ? 'none' : 'flex';
    });

    // Scroll progress bar
    const sp = document.getElementById('scrollProgress');
    window.addEventListener('scroll', () => {
      const sh = document.documentElement.scrollHeight - window.innerHeight;
      const p = (window.scrollY / sh) * 100; sp.style.width = p + '%';
    });

    // Vehicle rows add/remove
    function addVehicleRow(){
      const tbody = document.querySelector('#vehicleTable tbody');
      const idx = tbody.rows.length;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><input class="vehicle-input" name="veh[${idx}][model]" placeholder="e.g., Swift VXI" required></td>
        <td><input class="vehicle-input" name="veh[${idx}][reg]" placeholder="RJxx XX xxxx" required></td>
        <td><input class="vehicle-input" name="veh[${idx}][year]" placeholder="YYYY" pattern="^20\\d{2}|19\\d{2}$" required></td>
        <td><input class="vehicle-input" name="veh[${idx}][color]" placeholder="Color"></td>
        <td>
          <select class="vehicle-input" name="veh[${idx}][fuel]">
            <option>Petrol</option><option>Diesel</option><option>CNG</option><option>EV</option>
          </select>
        </td>
        <td><input type="date" class="vehicle-input" name="veh[${idx}][ins]" required></td>
        <td><input type="date" class="vehicle-input" name="veh[${idx}][fit]" required></td>`;
      tbody.appendChild(tr);
    }
    function removeVehicleRow(){
      const tbody = document.querySelector('#vehicleTable tbody');
      if (tbody.rows.length > 1) tbody.deleteRow(tbody.rows.length - 1);
    }

    // Signature functionality
    let crsSignature = null;
    let ownerSignature = null;
    
    function initializeSignaturePads() {
      const crsCanvas = document.getElementById('crsSignaturePad');
      const ownerCanvas = document.getElementById('ownerSignaturePad');
      
      // Initialize signature pads
      crsSignature = new SignaturePad(crsCanvas);
      ownerSignature = new SignaturePad(ownerCanvas);
      
      // Adjust canvas size for high DPI displays
      function resizeCanvas(canvas) {
        const ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        canvas.getContext("2d").scale(ratio, ratio);
      }
      
      resizeCanvas(crsCanvas);
      resizeCanvas(ownerCanvas);
      
      window.addEventListener('resize', () => {
        resizeCanvas(crsCanvas);
        resizeCanvas(ownerCanvas);
      });
    }
    
    function clearSignature(type) {
      if (type === 'crs' && crsSignature) {
        crsSignature.clear();
      } else if (type === 'owner' && ownerSignature) {
        ownerSignature.clear();
      }
    }
    
    function saveSignature(type) {
      let signaturePad, dataField;
      
      if (type === 'crs') {
        signaturePad = crsSignature;
        dataField = document.querySelector('[name="crs_sign_data"]');
      } else {
        signaturePad = ownerSignature;
        dataField = document.querySelector('[name="owner_sign_data"]');
      }
      
      if (signaturePad && !signaturePad.isEmpty()) {
        const dataURL = signaturePad.toDataURL();
        
        // Create hidden input if it doesn't exist
        if (!dataField) {
          dataField = document.createElement('input');
          dataField.type = 'hidden';
          dataField.name = type === 'crs' ? 'crs_sign_data' : 'owner_sign_data';
          document.getElementById('agreementForm').appendChild(dataField);
        }
        
        dataField.value = dataURL;
        alert('Signature saved successfully!');
      } else {
        alert('Please provide a signature first.');
      }
    }

    // Convert form to key:value object
    function formToObject(form){
      const data = new FormData(form);
      const obj = {};
      for (const [k,v] of data.entries()){
        // handle arrays like veh[0][model]
        if (k.includes('[')){
          const parts = k.replace(/\]/g,'').split('['); // [ 'veh', '0', 'model']
          let ref = obj;
          parts.forEach((p,i)=>{
            if (i===0){ if (!ref[p]) ref[p] = {}; ref = ref[p]; }
            else if (i < parts.length-1){ if (!ref[p]) ref[p] = {}; ref = ref[p]; }
            else { ref[p] = v; }
          });
        } else {
          obj[k] = v;
        }
      }
      return obj;
    }

    // Build a readable email body
    function buildEmailBody(o){
      const vehicles = Object.values(o.veh || {}).map((r,i)=>`#${i+1} ${r.model || ''} | Reg: ${r.reg || ''} | Year: ${r.year || ''} | Fuel: ${r.fuel || ''} | Ins Exp: ${r.ins || ''} | Fit Exp: ${r.fit || ''}`).join('\n');
      return `Car Owner Tie-Up Agreement (70-30)\n\nDate: ${o.agreement_day}/${o.agreement_month}/${o.agreement_year}\n\n[Company]\nRep: ${o.crs_rep}\nAddress: ${o.crs_address}\nEmail: ${o.crs_email}\nPhone: ${o.crs_phone || ''}\n\n[Owner]\nName: ${o.owner_name}\nMobile: ${o.owner_mobile}\nAddress: ${o.owner_address}\nAadhar: ${o.owner_aadhar}\nEmail: ${o.owner_email || '-'}\n\n[Vehicles]\n${vehicles || '-'}\n\n[Bank]\nHolder: ${o.bank_name} | A/C: ${o.bank_ac} | IFSC: ${o.bank_ifsc}\n\n[Acknowledgements]\nRevenue: ${o.ack_revenue?'Yes':'No'}, Payout: ${o.ack_payout?'Yes':'No'}, Docs: ${o.ack_docs?'Yes':'No'}, Service: ${o.ack_service?'Yes':'No'}, Damage: ${o.ack_damage?'Yes':'No'}, Fines: ${o.ack_fines?'Yes':'No'}, Term: ${o.ack_term?'Yes':'No'}\n\n[Signatures]\nCompany: ${o.crs_sign_name} on ${o.crs_sign_date}\nOwner: ${o.owner_sign_name} on ${o.owner_sign_date}`;
    }

    // Preview email
    function previewEmail(){
      const form = document.getElementById('agreementForm');
      if (!form.reportValidity()) return;
      const o = formToObject(form);
      const body = buildEmailBody(o);
      alert(body);
    }

    // Save/Print PDF (uses browser print to save as PDF)
    function saveAsPDF(){
      window.print();
    }

    // Submit handler
    document.getElementById('agreementForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const form = e.currentTarget;
      if (!form.reportValidity()) return;
      const o = formToObject(form);
      const body = buildEmailBody(o);
      const to = o.send_to || 'carryrentalservices@gmail.com';

      // If EmailJS keys provided, try API first
      if (EMAILJS_PUBLIC_KEY && EMAILJS_SERVICE_ID && EMAILJS_TEMPLATE_ID){
        try{
          await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, {
            to_email: to,
            subject: `New Car Owner Agreement – ${o.owner_name || ''}`,
            message: body
          });
          alert('✅ Sent! We\'ve emailed the filled agreement details to CRS.');
          return;
        }catch(err){
          console.warn('EmailJS error, falling back to mailto:', err);
        }
      }

      // Fallback: open default mail client
      const subject = encodeURIComponent(`New Car Owner Agreement – ${o.owner_name || ''}`);
      const mailBody = encodeURIComponent(body);
      window.location.href = `mailto:${to}?subject=${subject}&body=${mailBody}`;
    });

    // Initialize signature pads when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Simple signature pad implementation
      window.SignaturePad = function(canvas) {
        const ctx = canvas.getContext('2d');
        let drawing = false;
        let lastX = 0;
        let lastY = 0;
        
        // Set up drawing properties
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        
        // Event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);
        
        // Touch events for mobile
        canvas.addEventListener('touchstart', handleTouch);
        canvas.addEventListener('touchmove', handleTouch);
        canvas.addEventListener('touchend', stopDrawing);
        
        function handleTouch(e) {
          e.preventDefault();
          const touch = e.touches[0];
          const mouseEvent = new MouseEvent('mousedown', {
            clientX: touch.clientX,
            clientY: touch.clientY
          });
          canvas.dispatchEvent(mouseEvent);
        }
        
        function startDrawing(e) {
          drawing = true;
          const rect = canvas.getBoundingClientRect();
          lastX = e.clientX - rect.left;
          lastY = e.clientY - rect.top;
        }
        
        function draw(e) {
          if (!drawing) return;
          const rect = canvas.getBoundingClientRect();
          const currentX = e.clientX - rect.left;
          const currentY = e.clientY - rect.top;
          
          ctx.beginPath();
          ctx.moveTo(lastX, lastY);
          ctx.lineTo(currentX, currentY);
          ctx.stroke();
          
          lastX = currentX;
          lastY = currentY;
        }
        
        function stopDrawing() {
          drawing = false;
        }
        
        return {
          clear: function() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
          },
          isEmpty: function() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            for (let i = 0; i < data.length; i += 4) {
              if (data[i + 3] !== 0) return false;
            }
            return true;
          },
          toDataURL: function() {
            return canvas.toDataURL();
          }
        };
      };
      
      // Initialize signature pads
      initializeSignaturePads();
    });
  </script>
</body>
</html>